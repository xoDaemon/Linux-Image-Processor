# Linux Image Processor

This repo contains python scripts used for scanning and profiling Linux EWF *E01* images. It is still **work in progress** and other features will be added. For the purpose of a demo, the scanning will only occur in the */var* directory of the image. The script is tested using **Python 3.10.12**.

## How to use
Right now, for the ease of use, a *config.ini* is required for running the script. The file must be created in the *config_files* directory. A template is provided. If other name/path is used for the config file, change it accordingly in the *config.py*. CLI configuration might be added in the future for streamlined use.

After creating the config file, run the main script with *python* as **sudo** from the *root* directory. Example:
```
sudo python3 image_processor.py
```

## Features

### 1. Image Mounting
A *bash* script is integrated for E01 image mounting on the system.

### 2. Data Collection
The program scans and collects various data and metadata about the processed filesystem. The information is then stored in a **local**, portable, relational database. This is achieved by using [sqlite3](https://docs.python.org/3/library/sqlite3.html) for python.

The following information about the *filesystem* is recorded:
- uuid (generated by the tool)
- path
- hostname
- users and password hashes
- interfaces and IPs
- files

### 3. Persistence Detection
The tool uses [linPEAS](https://github.com/peass-ng/PEASS-ng/tree/master/linPEAS) for detection of **persistence vectors**. LinPEAS is run remotely on the target filesystem using a *bash* script. The full report is saved for further manual inspection, but the tool only extracts the possible **PEs** that were detected.

### 4. Malicious File Detection
A file can be searched in the [VirusTotal](https://www.virustotal.com/gui/home/upload) database using the [VirusTotal API](https://docs.virustotal.com/reference/overview) to determine if it is possibly malicious. Information about how different AV engines categorize it will be displayed. If found **malicious** by any engine, for each, a summary containing their **name**, the **last update**, the **verdict** and the **response method** can be displayed.

**This feature is implemented, but not yet integrated in the main script!**

## Dependencies
### Python Libs
- [python 3.10.12](https://www.python.org/downloads/release/python-31012/) (will probably work on other versions too)
- [python-magic](https://pypi.org/project/python-magic/)
- [requests](https://pypi.org/project/requests/)
- [colorama](https://pypi.org/project/colorama/)

### Other
- [sleuthkit](https://www.sleuthkit.org/sleuthkit/)
- [VirusTotal API](https://docs.virustotal.com/reference/overview)